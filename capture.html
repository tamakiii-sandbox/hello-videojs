<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charSet="utf-8"/>
    <meta http-equiv="x-ua-compatible" content="ie=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <link href="/node_modules/video.js/dist/video-js.min.css" rel="stylesheet">
    <script src="/node_modules/video.js/dist/video.min.js"></script>
  <script>

    window.addEventListener('DOMContentLoaded', () => {
      const button = document.querySelector('#speed-increment');
      button.addEventListener('click', () => {
        const video = document.querySelector('video');
        video.playbackRate = 2.0;
        video.defaultPlaybackRate = 2.0;
        video.play();
        // alert(video.defaultPlaybackRate);
        // alert(video.playbackRate);
      });
    });

  </script>
  <script>

    var onFailSoHard = function(e) {
      console.log('Reeeejected!', e);
    };

    window.addEventListener('DOMContentLoaded', () => {
      const button = document.querySelector('#snapshot');
      button.addEventListener('click', () => {
        var video = document.querySelector('video');
        var canvas = document.querySelector('canvas');
        var context = canvas.getContext('2d');

        video.pause();

        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;

        context.drawImage(video, 0, 0);

        const img = document.querySelector('img');
        img.crossOrigin = "Anonymous";
        img.src = canvas.toDataURL('image/webp');
        img.width = video.videoWidth;
        img.height = video.videoHeight;

        // downloadedImg = new Image;
        // downloadedImg.crossOrigin = "Anonymous";
        // downloadedImg.addEventListener("load", imageReceived, false);
        // downloadedImg.src = canvas.toDataURL('image/webp');

        // localStorage.setItem("saved-image-example", canvas.toDataURL("image/png"));

        let link = document.createElement('a');
        link.href = canvas.toDataURL("image/png");
        link.download = 'test.png';
        link.click();
      });
    });

  </script>
  </head>
  <body>
    <video
      id="my-player"
      class="video-js"
      controls
      preload="auto"
      poster="//vjs.zencdn.net/v/oceans.png"
      data-setup="{}"
      crossOrigin="anonymous"
      width="280" height="140"
      playsinline
      webkit-playsinline
      >
      <!-- <source src="/video/oceans.mp4" type="video/mp4"></source> -->
      <!-- <source src="/video/oceans.webm" type="video/webm"></source> -->
      <!-- <source src="/video/oceans.ogv" type="video/ogg"></source> -->
      <source src="//vjs.zencdn.net/v/oceans.mp4" type="video/mp4"></source>
      <source src="//vjs.zencdn.net/v/oceans.webm" type="video/webm"></source>
      <source src="//vjs.zencdn.net/v/oceans.ogv" type="video/ogg"></source>
      <p class="vjs-no-js">
      To view this video please enable JavaScript, and consider upgrading to a
      web browser that
      <a href="https://videojs.com/html5-video-support/" target="_blank">
        supports HTML5 video
      </a>
      </p>
    </video>

    <canvas width="200" height="200" crossOrigin="anonymous"></canvas>
    <!-- <canvas style="display:none;"></canvas> -->
    <img img crossOrigin="anonymous" />

    <input type="button" value="Speed++" id="speed-increment" />
    <input type="button" value="Snapshot" id="snapshot" />
  </body>
</html>
